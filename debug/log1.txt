
======================log start=======================
[info 0][Tue Nov 26 16:14:47 2024]file:protocol/transport/tcp.c  fun:tcp_client_start  line:573 
connect to [192.168.1.20:8080] OK
等待消息队列非空...
---------------->POLL   IN
解析头部 version:http/1.1 code:401 reason:Unauthorized
============================show head
num:1
--------------show line--------------
name:WWW-Authenticate
key:Digest realm value:/cwmp 
key:qop value:auth-int 
key:nonce value:0447abac039f384b4f7c60fc7b6e1414 
key:opaque value:3fe9b40d19cbd9031e8512aff1559ca6 
[info 1][Tue Nov 26 16:14:47 2024]file:protocol/session/http.c  fun:http_client_accept  line:2281 
http 头部处理完毕 ...
 客户端 http 报文接收处理
需要摘要认证 ...
计算摘要认证 ...
计算摘要值所需参数：
pszNonce:0447abac039f384b4f7c60fc7b6e1414
pszCNonce:da34d4e22
pszUser:admin
pszRealm:/cwmp
pszPass:123456
pszAlg:md5
szNonceCount:00000010
pszMethod:GET
pszQop:auth-int
pszURI:/cwmp
Response = 02065d3f0255b0670b4225c5866f254a
发送摘要认证测试 长度:269 内容:GET /cwmp http/1.1
Authorization: Digest username="admin", realm=/cwmp, nonce=0447abac039f384b4f7c60fc7b6e1414, uri="/cwmp", response="02065d3f0255b0670b4225c5866f254a", opaque=3fe9b40d19cbd9031e8512aff1559ca6, qop=auth-int, nc=10, cnonce="da34d4e22"
Content-Length:0


http_status_head_pro：http 401 处理， 对方要求认证 
---------------->POLL   IN
解析头部 version:HTTP/1.1 code:200 reason:OK
============================show head
num:3
--------------show line--------------
name:Host
key:cwmp.example.com 
--------------show line--------------
name:Content-Type
key:text/xml 
key:charset value:"UTF-8" 
--------------show line--------------
name:Content-Length
key:14 
[info 2][Tue Nov 26 16:14:47 2024]file:protocol/session/http.c  fun:http_client_accept  line:2281 
http 头部处理完毕 ...
 客户端 http 报文接收处理
----->__get_http_payload_len payloadNeedLen:14
开始发送条件变量....
开始处理消息队列表...
---->http_status_data_pro 完成, retHttpMsg :0
msgData len:14 msg:
【hello visitor!】
已经存入消息队列
sessioncpe_status_start ret:0
sessioncpe_status_establish_connection 来了......
计算摘要值所需参数：
pszNonce:0447abac039f384b4f7c60fc7b6e1414
pszCNonce:da34d4e22
pszUser:admin
pszRealm:/cwmp
pszPass:123456
pszAlg:md5
szNonceCount:00000011
pszMethod:POST
pszQop:auth-int
pszURI:/cwmp
Response = 60f155446acfc21a349574a772d9a23a
客户端发送msg 长度:1523 内容:POST /cwmp http/1.1
Authorization: Digest username="admin", realm=/cwmp, nonce=0447abac039f384b4f7c60fc7b6e1414, uri="/cwmp", response="60f155446acfc21a349574a772d9a23a", opaque=3fe9b40d19cbd9031e8512aff1559ca6, qop=auth-int, nc=11, cnonce="da34d4e22"
Content-Type: text/xml; charset="UTF-8"
Content-Length: 1169
SOAPAction:"urn:dslforum-org:cwmp-1-4"

<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:cwmp="urn:dslforum-org:cwmp-1-4">
<soap:Header>
<cwmp:ID soapenv:mustUnderstand=1>
long123
</cwmp:ID>
</soap:Header>
<soap:Body>
<cwmp:Inform>
<DeviceId>
<Manufacturer>
设备制造商的名称
</Manufacturer>
<OUI>
设备特定序列号的产品类别的标识符
</OUI>
<ProductClass>
特定序列号的产品类别的标识符
</ProductClass>
<SerialNumber>
特定设备的标识符
</SerialNumber>
</DeviceId>
<EventList soapenc:arrayType=tns:ParameterValueStruct[2]>
<EventStruct>
<EventCode>
0 BOOTSTRAP
</EventCode>
<CommandKey>
CommandKey_0
</CommandKey>
</EventStruct>
<EventStruct>
<EventCode>
1 BOOT
</EventCode>
<CommandKey>
CommandKey_1
</CommandKey>
</EventStruct>
</EventList>
<MaxEnvelopes>
1
</MaxEnvelopes>
<CurrentTime>
2024-11-19T17:51:00
</CurrentTime>
<RetryCount>
0
</RetryCount>
<ParameterList>
<ParameterValueStruct>
<Name>
parameter_1
</Name>
<Value>
76616c75655f32
</Value>
</ParameterValueStruct>
<ParameterValueStruct>
<Name>
parameter_2
</Name>
<Value>
76616c75655f32
</Value>
</ParameterValueStruct>
</ParameterList>
</cwmp:Inform>
</soap:Body>
</soap:Envelope>

发送完成，返回值 ret:1523
等待消息队列非空...
---------------->POLL   IN
解析头部 version:http/1.1 code:200 reason:OK
============================show head
num:4
--------------show line--------------
name:WWW-Authenticate
key:Digest realm value:/cwmp 
key:qop value:auth-int 
key:nonce value:0447abac039f384b4f7c60fc7b6e1414 
key:opaque value:3fe9b40d19cbd9031e8512aff1559ca6 
--------------show line--------------
name:Content-Type
key:text/xml 
key:charset value:"UTF-8" 
--------------show line--------------
name:Content-Length
key:385 
--------------show line--------------
name:SOAPAction
key:"urn:dslforum-org:cwmp-1-4" 
[info 3][Tue Nov 26 16:14:48 2024]file:protocol/session/http.c  fun:http_client_accept  line:2281 
http 头部处理完毕 ...
 客户端 http 报文接收处理
需要摘要认证 ...
计算摘要认证 ...
----->__get_http_payload_len payloadNeedLen:385
开始发送条件变量....
开始处理消息队列表...
-->msgData len:385 msg:
【<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:cwmp="urn:dslforum-org:cwmp-1-4">
<soap:Header>
<cwmp:ID soapenv:mustUnderstand=1>
long123
</cwmp:ID>
<cwmp:HoldRequests soapenv:mustUnderstand=1>
false
</cwmp:HoldRequests>
</soap:Header>
<soap:Body>
<cwmp:InformResponse>
<MaxEnvelopes>
1
</MaxEnvelopes>
</cwmp:InformResponse>
</soap:Body>
</soap:Envelope>
】
---->http_status_data_pro 完成, retHttpMsg :0
已经存入消息队列
开始清空 taskQueue

-------------------【cpe会话 task_pro】---------------  
__aux_task_queue_pro 返回值 ret:-2 

-------------------【cpe会话 task_void】---------------  

-------------------【cpe会话 task_pro】---------------  
计算摘要值所需参数：
pszNonce:0447abac039f384b4f7c60fc7b6e1414
pszCNonce:0d6cb05b4
pszUser:admin
pszRealm:/cwmp
pszPass:123456
pszAlg:md5
szNonceCount:00000012
pszMethod:POST
pszQop:auth-int
pszURI:/cwmp
Response = 2c0a745b5bbb0f2a49db6433b0b38ac8
客户端发送msg 长度:351 内容:POST /cwmp http/1.1
Authorization: Digest username="admin", realm=/cwmp, nonce=0447abac039f384b4f7c60fc7b6e1414, uri="/cwmp", response="2c0a745b5bbb0f2a49db6433b0b38ac8", opaque=3fe9b40d19cbd9031e8512aff1559ca6, qop=auth-int, nc=12, cnonce="0d6cb05b4"
Content-Type: text/xml; charset="UTF-8"
Content-Length: 0
SOAPAction:"urn:dslforum-org:cwmp-1-4"


发送完成，返回值 ret:351
等待消息队列非空...
