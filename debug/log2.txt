
======================log start=======================
开始清空 taskQueue

-------------------【cpe会话 establish_connection】---------------  
等待消息队列非空...
---->POLL    IN  ready:0
查找http第一行并解析 成功
解析http头部 成功
============================show head
num:3
--------------show line--------------
name:Host
key:example.com 
--------------show line--------------
name:Content-Type
key:text/xml 
key:charset value:"UTF-8" 
--------------show line--------------
name:Content-Length
key:105 
认证失败，要求 摘要认证...
查找http第一行并解析 失败
---->POLL    IN  ready:0
查找http第一行并解析 成功
解析http头部 成功
============================show head
num:2
--------------show line--------------
name:Authorization
key:Digest username value:"admin" 
key:realm value:/cwmp 
key:nonce value:0447abac039f384b4f7c60fc7b6e1414 
key:uri value:"/cwmp" 
key:response value:"02065d3f0255b0670b4225c5866f254a" 
key:opaque value:3fe9b40d19cbd9031e8512aff1559ca6 
key:qop value:auth-int 
key:nc value:10 
key:cnonce value:"da34d4e22" 
--------------show line--------------
name:Content-Length
key:0 
存在 Authorization，可以开始认证 len:13 result:0 str:Authorization name:Authorization
摘要认证开始 ...
  客户端上来的 nonce:0447abac039f384b4f7c60fc7b6e1414 本地:0447abac039f384b4f7c60fc7b6e1414
  本地nc值:0 报文nc值:10
[info 0][Tue Nov 26 16:14:47 2024]file:protocol/session/http.c  fun:__http_head_pro  line:923 
  用户名：admin 密码：123456

计算摘要值所需参数：
pszNonce:0447abac039f384b4f7c60fc7b6e1414
pszCNonce:da34d4e22
pszUser:admin
pszRealm:/cwmp
pszPass:123456
pszAlg:md5
szNonceCount:00000010
pszMethod:GET
pszQop:auth-int
pszURI:/cwmp
Response = 02065d3f0255b0670b4225c5866f254a client msgResponse:02065d3f0255b0670b4225c5866f254a
摘要认证成功！
【摘要认证】 最终停下的步骤 4
----->__get_http_payload_len payloadNeedLen:0
----->http_status_data_pro 开始 ......
【】
开始发送条件变量....
开始处理消息队列表...
-->msgData len:0 msg:
【空】
开始发送 http 的回复信息
__aux_establish_connection 失败，返回值 -1
---->http_status_data_pro 完成, retHttpMsg :0

-------------------【cpe会话 establish_connection】---------------  
等待消息队列非空...
---->POLL    IN  ready:0
查找http第一行并解析 成功
解析http头部 成功
============================show head
num:4
--------------show line--------------
name:Authorization
key:Digest username value:"admin" 
key:realm value:/cwmp 
key:nonce value:0447abac039f384b4f7c60fc7b6e1414 
key:uri value:"/cwmp" 
key:response value:"60f155446acfc21a349574a772d9a23a" 
key:opaque value:3fe9b40d19cbd9031e8512aff1559ca6 
key:qop value:auth-int 
key:nc value:11 
key:cnonce value:"da34d4e22" 
--------------show line--------------
name:Content-Type
key:text/xml 
key:charset value:"UTF-8" 
--------------show line--------------
name:Content-Length
key:1169 
--------------show line--------------
name:SOAPAction
key:"urn:dslforum-org:cwmp-1-4" 
存在 Authorization，可以开始认证 len:13 result:0 str:Authorization name:Authorization
摘要认证开始 ...
  客户端上来的 nonce:0447abac039f384b4f7c60fc7b6e1414 本地:0447abac039f384b4f7c60fc7b6e1414
  本地nc值:10 报文nc值:11
[info 1][Tue Nov 26 16:14:47 2024]file:protocol/session/http.c  fun:__http_head_pro  line:923 
  用户名：admin 密码：123456

计算摘要值所需参数：
pszNonce:0447abac039f384b4f7c60fc7b6e1414
pszCNonce:da34d4e22
pszUser:admin
pszRealm:/cwmp
pszPass:123456
pszAlg:md5
szNonceCount:00000011
pszMethod:POST
pszQop:auth-int
pszURI:/cwmp
Response = 60f155446acfc21a349574a772d9a23a client msgResponse:60f155446acfc21a349574a772d9a23a
摘要认证成功！
【摘要认证】 最终停下的步骤 4
----->__get_http_payload_len payloadNeedLen:1169
----->http_status_data_pro 开始 ......
【<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:cwmp="urn:dslforum-org:cwmp-1-4">
<soap:Header>
<cwmp:ID soapenv:mustUnderstand=1>
long123
</cwmp:ID>
</soap:Header>
<soap:Body>
<cwmp:Inform>
<DeviceId>
<Manufacturer>
设备制造商的名称
</Manufacturer>
<OUI>
设备特定序列号的产品类别的标识符
</OUI>
<ProductClass>
特定序列号的产品类别的标识符
</ProductClass>
<SerialNumber>
特定设备的标识符
</SerialNumber>
</DeviceId>
<EventList soapenc:arrayType=tns:ParameterValueStruct[2]>
<EventStruct>
<EventCode>
0 BOOTSTRAP
</EventCode>
<CommandKey>
CommandKey_0
</CommandKey>
</EventStruct>
<EventStruct>
<EventCode>
1 BOOT
</EventCode>
<CommandKey>
CommandKey_1
</CommandKey>
</EventStruct>
</EventList>
<MaxEnvelopes>
1
</MaxEnvelopes>
<CurrentTime>
2024-11-19T17:51:00
</CurrentTime>
<RetryCount>
0
</RetryCount>
<ParameterList>
<ParameterValueStruct>
<Name>
parameter_1
</Name>
<Value>
76616c75655f32
</Value>
</ParameterValueStruct>
<ParameterValueStruct>
<Name>
parameter_2
</Name>
<Value>
76616c75655f32
</Value>
</ParameterValueStruct>
</ParameterList>
</cwmp:Inform>
</soap:Body>
</soap:Envelope>
】
开始发送条件变量....
开始处理消息队列表...
-->msgData len:1169 msg:
【<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:cwmp="urn:dslforum-org:cwmp-1-4">
<soap:Header>
<cwmp:ID soapenv:mustUnderstand=1>
long123
</cwmp:ID>
</soap:Header>
<soap:Body>
<cwmp:Inform>
<DeviceId>
<Manufacturer>
设备制造商的名称
</Manufacturer>
<OUI>
设备特定序列号的产品类别的标识符
</OUI>
<ProductClass>
特定序列号的产品类别的标识符
</ProductClass>
<SerialNumber>
特定设备的标识符
</SerialNumber>
</DeviceId>
<EventList soapenc:arrayType=tns:ParameterValueStruct[2]>
<EventStruct>
<EventCode>
0 BOOTSTRAP
</EventCode>
<CommandKey>
CommandKey_0
</CommandKey>
</EventStruct>
<EventStruct>
<EventCode>
1 BOOT
</EventCode>
<CommandKey>
CommandKey_1
</CommandKey>
</EventStruct>
</EventList>
<MaxEnvelopes>
1
</MaxEnvelopes>
<CurrentTime>
2024-11-19T17:51:00
</CurrentTime>
<RetryCount>
0
</RetryCount>
<ParameterList>
<ParameterValueStruct>
<Name>
parameter_1
</Name>
<Value>
76616c75655f32
</Value>
</ParameterValueStruct>
<ParameterValueStruct>
<Name>
parameter_2
</Name>
<Value>
76616c75655f32
</Value>
</ParameterValueStruct>
</ParameterList>
</cwmp:Inform>
</soap:Body>
</soap:Envelope>
】
---->http_status_data_pro 完成, retHttpMsg :0
收到来自 192.168.1.20:8081 的 Inform 消息，开始握手.....
客户端发送msg 长度:634 内容:http/1.1 200 OK
WWW-Authenticate: Digest realm=/cwmp, qop=auth-int, nonce=0447abac039f384b4f7c60fc7b6e1414, opaque=3fe9b40d19cbd9031e8512aff1559ca6
Content-Type: text/xml; charset="UTF-8"
Content-Length: 385
SOAPAction:"urn:dslforum-org:cwmp-1-4"

<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:cwmp="urn:dslforum-org:cwmp-1-4">
<soap:Header>
<cwmp:ID soapenv:mustUnderstand=1>
long123
</cwmp:ID>
<cwmp:HoldRequests soapenv:mustUnderstand=1>
false
</cwmp:HoldRequests>
</soap:Header>
<soap:Body>
<cwmp:InformResponse>
<MaxEnvelopes>
1
</MaxEnvelopes>
</cwmp:InformResponse>
</soap:Body>
</soap:Envelope>

发送完成，返回值 ret:634

-------------------【cpe会话 task】---------------  
__aux_task_pro  来了 ......

---------------- show task queue ----------------
cnt:25 请求任务 status:0 method:GetParameterValues soapNode:0x7f2834000f40 soapNodeResponse:0
cnt:26 请求任务 status:0 method:SetParameterValues soapNode:0x7f2834001b80 soapNodeResponse:0
__aux_task_pro 返回值 ret:0  
---->POLL    IN  ready:0
查找http第一行并解析 成功
解析http头部 成功
============================show head
num:4
--------------show line--------------
name:Authorization
key:Digest username value:"admin" 
key:realm value:/cwmp 
key:nonce value:0447abac039f384b4f7c60fc7b6e1414 
key:uri value:"/cwmp" 
key:response value:"2c0a745b5bbb0f2a49db6433b0b38ac8" 
key:opaque value:3fe9b40d19cbd9031e8512aff1559ca6 
key:qop value:auth-int 
key:nc value:12 
key:cnonce value:"0d6cb05b4" 
--------------show line--------------
name:Content-Type
key:text/xml 
key:charset value:"UTF-8" 
--------------show line--------------
name:Content-Length
key:0 
--------------show line--------------
name:SOAPAction
key:"urn:dslforum-org:cwmp-1-4" 
存在 Authorization，可以开始认证 len:13 result:0 str:Authorization name:Authorization
摘要认证开始 ...
  客户端上来的 nonce:0447abac039f384b4f7c60fc7b6e1414 本地:0447abac039f384b4f7c60fc7b6e1414
  本地nc值:11 报文nc值:12
[info 2][Tue Nov 26 16:14:48 2024]file:protocol/session/http.c  fun:__http_head_pro  line:923 
  用户名：admin 密码：123456

计算摘要值所需参数：
pszNonce:0447abac039f384b4f7c60fc7b6e1414
pszCNonce:0d6cb05b4
pszUser:admin
pszRealm:/cwmp
pszPass:123456
pszAlg:md5
szNonceCount:00000012
pszMethod:POST
pszQop:auth-int
pszURI:/cwmp
Response = 2c0a745b5bbb0f2a49db6433b0b38ac8 client msgResponse:2c0a745b5bbb0f2a49db6433b0b38ac8
摘要认证成功！
【摘要认证】 最终停下的步骤 4
----->__get_http_payload_len payloadNeedLen:0
----->http_status_data_pro 开始 ......
【】
开始发送条件变量....
---->http_status_data_pro 完成, retHttpMsg :0
查找http第一行并解析 失败
---->POLL    IN  ready:0
[info 3][Tue Nov 26 16:14:51 2024]file:protocol/transport/tcp.c  fun:thread_tcp_transceiver  line:409 
i=0 [192.168.1.20-8081] 断开连接

